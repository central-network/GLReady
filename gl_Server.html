<!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            body, html { 
                width: 100vw; height: 100vh; overflow: hidden;
                margin: 0; overscroll-behavior-x: none; }

            canvas { width: 100%; height: 100%; }
            table {
                position: fixed;
                right: 10px;
                top: 10px;
                font: 14px/1.38em "Ubuntu Mono";
            }

            * { border: 0; }
            td { position: relative; }

            *:focus { outline: 0; }
            td::before {
                content: attr(id) ":";
                position: absolute;
                right: 100%;
                pointer-events: none;
                color: rgb(152, 152, 152);
            }
        </style>
    </head>
    <body>
        <canvas id="bgl2"></canvas>
        <table>
            <tr><td id="dxCamera">   <input type="range" max="500" min="-500" step="1" /></td></tr>
            <tr><td id="dyCamera">   <input type="range" max="500" min="-500" step="1" /></td></tr>
            <tr><td id="dzCamera">   <input type="range" max="500" min="-500" step="1" /></td></tr>

            <tr><td id="rxCamera">   <input type="range" max="3.14" min="-3.14" step="0.01" /></td></tr>
            <tr><td id="ryCamera">   <input type="range" max="3.14" min="-3.14" step="0.01" /></td></tr>

            <tr><td id="sxCamera">   <input type="range" max="3" min="0" step="0.1" /></td></tr>
            <tr><td id="syCamera">   <input type="range" max="3" min="0" step="0.1" /></td></tr>
            <tr><td id="szCamera">   <input type="range" max="3" min="0" step="0.1" /></td></tr>
        </table>


        <script type="module">
            let canvas  = document.getElementById( 'bgl2' );
            let buffer  = new SharedArrayBuffer( 1e8 );
            let context = canvas.getContext("webgl2"); 

            import { Matrix4 } from "./Matrix4.js"
            import { Pointer } from "./Pointer.js"
            import { GLServer } from "./GLServer.js"
            import { BindServer } from "./BindServer.js"
            import { ScreenServer } from "./ScreenServer.js"
            import { Perspective } from "./Camera.js"

            memory( buffer );

            let ptr_bind = malloc( BindServer.byteLength )
            let ptr_screen = malloc( ScreenServer.byteLength )
            let screenServer = new ScreenServer( ptr_screen, canvas )

            let glServer = new GLServer()

            glServer.canvas = canvas
            glServer.camera = Perspective.create(
                Math.rad( 80 ), innerWidth / innerHeight, .001, 1e3
            )

            let bindServer = new BindServer( ptr_bind, canvas )


            console.log(bindServer)
            console.log(glServer)
            
        </script>
        
    </body>
</html>